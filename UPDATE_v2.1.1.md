# SignalVizTool v2.1.1 更新說明

> **重要更新：整合原始版本核心功能**
>
> 更新日期: 2025-01-02
> 版本: 2.1.1
> 更新類型: 功能整合

---

## 📋 更新摘要

根據用戶反饋，我們發現在從 v1.0 升級到 v2.1 的過程中，遺漏了原始版本中非常重要且實用的功能。本次更新將這些核心功能完整整合回 v2.1 系統。

### ✨ 整合的功能

1. **合併多個 CSV 檔案**
2. **依時間戳對齊合併兩個 CSV 檔案**
3. **選擇多個檔案並批次繪圖**

這些功能是使用者日常工作中不可或缺的工具，我們確保它們在新系統中得到完整保留。

---

## 🎯 新增內容

### 1. 新增 Tab 7: 實用工具

在主應用程式中新增第 7 個標籤頁「🛠️ 實用工具」，專門提供 CSV 操作和批次處理功能。

**位置**: `main_v2.1.py` → Tab 7

**包含功能**:
- CSV 檔案簡單合併
- 時間戳對齊合併
- 批次繪圖

### 2. 三大核心功能

#### 功能 1: 合併多個 CSV 檔案

**功能描述**:
將多個 CSV 檔案簡單串接合併成一個檔案（垂直堆疊）

**適用場景**:
- 連續多次測量的數據合併
- 不同時段的記錄整合
- 多個相同格式檔案的統一處理

**特色**:
- 支援選擇多個檔案
- 多執行緒處理，不阻塞 UI
- 即時進度條顯示
- 完成後顯示總記錄數

**操作步驟**:
```
1. Tab 7: 點擊「選擇檔案並合併」
2. 選擇要合併的多個 CSV 檔案（至少 2 個）
3. 選擇儲存位置和檔名
4. 等待合併完成
```

#### 功能 2: 依時間戳對齊合併

**功能描述**:
將兩個 CSV 檔案依照時間戳對齊後合併，適用於不同感測器數據同步分析

**適用場景**:
- 振動數據 + 電流數據同步分析
- 多感測器數據時間對齊
- 不同採樣率數據整合

**特色**:
- 自動找到重疊時間範圍
- 使用最近鄰時間戳對齊
- 支援自訂時間戳欄位名稱
- 自動處理時間格式

**操作步驟**:
```
1. Tab 7: 點擊「選擇兩個檔案對齊合併」
2. 選擇第一個 CSV 檔案（例如：振動數據）
3. 選擇第二個 CSV 檔案（例如：電流數據）
4. 輸入時間戳欄位名稱（預設: timestamp）
5. 選擇儲存位置
```

#### 功能 3: 批次繪圖

**功能描述**:
選擇多個 CSV 檔案，為每個檔案生成圖表並自動保存為 PNG

**適用場景**:
- 快速查看多個檔案內容
- 生成報告用圖表
- 比較不同測試結果

**特色**:
- 自動識別共同欄位
- 彈出視窗讓用戶選擇要繪製的欄位
- 自動為每個檔案生成獨立圖表
- 高品質 PNG 輸出（150 DPI）

**操作步驟**:
```
1. Tab 7: 點擊「選擇多個檔案並繪圖」
2. 選擇要繪製的多個 CSV 檔案
3. 在彈出視窗中勾選要繪製的欄位
4. 選擇圖表輸出目錄
5. 等待批次繪圖完成
```

---

## 💻 技術實作細節

### 程式碼變更

**檔案**: `main_v2.1.py`

**新增內容**:
1. 新增 Tab 7 標籤頁定義（第 110-112 行）
2. 新增 `_setup_utils_tab()` 方法（第 869-950 行）
3. 新增 `merge_csv_files()` 方法（第 952-1015 行）
4. 新增 `align_merge_csv()` 方法（第 1017-1124 行）
5. 新增 `multi_file_plot()` 方法（第 1126-1225 行）
6. 新增 `_select_columns_dialog()` 輔助方法（第 1227-1286 行）

**總新增代碼**: 約 400+ 行

### 設計特點

#### 1. 完整保留原始邏輯
從原始 `SignalVizTool.py` 中的實作邏輯完整移植，確保功能行為一致。

#### 2. 現代化改進
- 使用 `pathlib.Path` 處理路徑（跨平台相容）
- 多執行緒處理避免 UI 凍結
- 完整錯誤處理和使用者提示
- 日誌記錄所有操作

#### 3. UI/UX 優化
- 清晰的功能分區（三個獨立 LabelFrame）
- 詳細的功能說明
- 即時進度條反饋
- 友善的操作提示

#### 4. 與 v2.1 體系一致
- 使用 ttk 現代化元件
- 整合進統一的日誌系統
- 狀態列即時更新
- 符合整體設計風格

---

## 📚 文檔更新

### 更新的文檔

#### 1. DEMO_GUIDE.md
- 更新「主介面概覽」：6 個標籤頁 → 7 個標籤頁
- 新增「Tab 7: 實用工具」完整章節
  - 功能說明
  - 操作步驟
  - 使用場景
  - 實戰範例
  - 注意事項
  - 建議工作流程

#### 2. README_V2.1.md
- 新增「原始版本核心功能（保留）」章節
- 說明 CSV 操作工具的重要性

#### 3. UPDATE_v2.1.1.md (本文件)
- 完整記錄此次更新內容

---

## 🎯 使用範例

### 範例 1: 合併一週的振動數據

**場景**: 每天測量一次機器振動，一週累積 7 個 CSV 檔案

**步驟**:
```
1. 啟動 main_v2.1.py
2. 切換到 Tab 7
3. 點擊「選擇檔案並合併」
4. 選擇 monday.csv ~ sunday.csv
5. 儲存為 week_vibration.csv
6. 在 Tab 1 載入 week_vibration.csv
7. 使用 Tab 2-6 進行深度分析
```

**結果**:
- 單一檔案包含完整一週數據
- 便於進行長期趨勢分析
- 可使用所有進階分析功能

---

### 範例 2: 同步振動與電流數據

**場景**: 同時記錄機器振動和電流，但數據在兩個獨立檔案中

**步驟**:
```
1. 切換到 Tab 7
2. 點擊「選擇兩個檔案對齊合併」
3. 選擇 vibration.csv
4. 選擇 current.csv
5. 輸入時間戳欄位: timestamp
6. 儲存為 synced_data.csv
7. 分析振動與電流的相關性
```

**結果**:
- 振動和電流數據時間對齊
- 可分析兩者之間的關聯
- 適用於故障診斷

---

### 範例 3: 批次生成測試報告圖表

**場景**: 在 10 個不同轉速下測試，需要生成所有圖表

**步驟**:
```
1. 切換到 Tab 7
2. 點擊「選擇多個檔案並繪圖」
3. 選擇 1000rpm.csv ~ 10000rpm.csv（10 個檔案）
4. 勾選 acceleration, velocity 欄位
5. 選擇輸出目錄
6. 自動生成 10 張圖表
```

**結果**:
- 每個轉速一張高品質圖表
- 便於製作測試報告
- 視覺化對比不同條件

---

## ⚠️ 重要提示

### 版本兼容性

- ✅ 完全向下相容 v2.1.0
- ✅ 不影響現有的進階分析功能
- ✅ 新增的工具是獨立模組，可選擇性使用

### 升級方式

**從 v2.1.0 升級到 v2.1.1**:
```bash
# 備份舊版本（可選）
cp main_v2.1.py main_v2.1.0_backup.py

# 下載最新版本
# 直接覆蓋 main_v2.1.py

# 無需重新安裝依賴
# 直接啟動即可使用
python main_v2.1.py
```

---

## 📊 功能對比

| 功能 | v1.0 原始版 | v2.1.0 | v2.1.1 |
|------|-------------|--------|--------|
| CSV 合併 | ✅ | ❌ | ✅ |
| 時間戳對齊合併 | ✅ | ❌ | ✅ |
| 批次繪圖 | ✅ | ❌ | ✅ |
| FFT 分析 | ❌ | ✅ | ✅ |
| 小波分析 | ❌ | ✅ | ✅ |
| AI 分析 | ❌ | ✅ | ✅ |
| 現代化 UI | ❌ | ✅ | ✅ |
| 完整文檔 | ❌ | ✅ | ✅ |

**總功能數**:
- v1.0: 8 個
- v2.1.0: 35+ 個
- v2.1.1: 38+ 個 ⬆️

---

## 🎉 用戶反饋

> **問題**: "原始版本的 CSV 合併功能很實用，為什麼在 v2.1 中沒有了？"
>
> **回應**: 感謝您的反饋！我們在追求進階功能時，確實遺漏了這些日常必備的實用工具。v2.1.1 已經完整整合這些功能。

> **需求**: "我需要合併多個測試檔案，然後用新的 AI 功能分析"
>
> **實現**: v2.1.1 完美支援！Tab 7 合併數據 → Tab 1 載入 → Tab 6 AI 分析

---

## 🚀 未來計劃

### 實用工具的進一步增強

1. **更多合併選項**
   - 水平合併（按欄位）
   - 智慧欄位映射
   - 批次對齊合併

2. **進階批次處理**
   - 批次應用濾波器
   - 批次 FFT 分析
   - 批次異常檢測

3. **報告生成**
   - 自動生成 PDF 報告
   - 整合所有分析結果
   - 可自訂報告模板

---

## 📞 支援

如有任何問題或建議，請參閱：
- `DEMO_GUIDE.md` - Tab 7 詳細使用指南
- `README_V2.1.md` - 系統總覽

---

## ✅ 檢查清單

更新完成後，請確認：

- ✅ 啟動 `main_v2.1.py` 成功
- ✅ 看到 7 個標籤頁（包含「實用工具」）
- ✅ Tab 7 顯示三個功能區域
- ✅ 進度條正常顯示
- ✅ 可以選擇多個 CSV 檔案
- ✅ 合併功能正常運作
- ✅ 批次繪圖生成 PNG 檔案

---

<div align="center">

**SignalVizTool v2.1.1**

*保留經典，擁抱創新*

**完整功能 · 向下相容 · 持續進化**

---

更新日期: 2025-01-02

*感謝所有用戶的寶貴反饋！*

</div>
